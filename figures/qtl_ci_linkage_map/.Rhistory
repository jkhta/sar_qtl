theme(legend.text = element_text(size = 20),
legend.title = element_blank(),
axis.title = element_text(size = 20),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
plot.title = element_text(hjust = 0.5)) +
scale_x_continuous(breaks = round(seq(min(path_data_diff_B5$est), max(path_data_diff_B5$est), by = 0.3), 1)) +
ggtitle("SAR5")
ggarrange(path_data_diff_B4_ggplot, path_data_diff_B5_ggplot,
labels = c("A", "B"),
ncol = 2)
path_data_diff_B5_ggplot <- ggplot(data = path_data_diff_B5, aes(x = est, y = pop_facet, color = effect_type)) +
geom_point(aes(size = 0.3)) +
geom_errorbarh(aes(xmax = est + se, xmin = est - se), height = 0.1) +
geom_vline(xintercept = 0,
color = "black", size = 0.25) +
facet_wrap(~ trait_facet, nrow = 1) +
xlab("QTL effect") +
ylab("Population") +
theme(legend.text = element_text(size = 20),
legend.title = element_blank(),
axis.title = element_text(size = 20),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
plot.title = element_text(hjust = 0.5)) +
scale_x_continuous(breaks = round(seq(min(path_data_diff_B5$est), max(path_data_diff_B5$est), by = 0.3), 1)) +
ggtitle("SAR5")
ggarrange(path_data_diff_B4_ggplot, path_data_diff_B5_ggplot,
labels = c("A", "B"),
ncol = 2)
path_data_FRI_FLC_ind$effect_type <- revalue(path_data_FRI_FLC_ind$effect_type, c("dir" = "Direct", "ind" = "Indirect"))
geom_point_size <- 1
path_data_diff_B4 <- subset(path_data_FRI_FLC_ind, env == "diff" & allele_comb == "B4")
path_data_diff_B4_ggplot <- ggplot(data = path_data_diff_B4, aes(x = est, y = pop_facet, color = effect_type)) +
geom_point() +
geom_errorbarh(aes(xmax = est + se, xmin = est - se), height = 0.1) +
geom_vline(xintercept = 0,
color = "black", size = 0.25) +
facet_wrap(~ trait_facet, nrow = 1) +
xlab("QTL effect") +
ylab("Population") +
theme(legend.text = element_text(size = 20),
legend.title = element_blank(),
axis.title = element_text(size = 20),
axis.text.y = element_text(size = 20),
plot.title = element_text(hjust = 0.5),
legend.position = "none") +
ggtitle("SAR4")
path_data_diff_B5 <- subset(path_data_FRI_FLC_ind, env == "diff" & allele_comb == "B5")
path_data_diff_B5_ggplot <- ggplot(data = path_data_diff_B5, aes(x = est, y = pop_facet, color = effect_type)) +
geom_point() +
geom_errorbarh(aes(xmax = est + se, xmin = est - se), height = 0.1) +
geom_vline(xintercept = 0,
color = "black", size = 0.25) +
facet_wrap(~ trait_facet, nrow = 1) +
xlab("QTL effect") +
ylab("Population") +
theme(legend.text = element_text(size = 20),
legend.title = element_blank(),
axis.title = element_text(size = 20),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
plot.title = element_text(hjust = 0.5)) +
scale_x_continuous(breaks = round(seq(min(path_data_diff_B5$est), max(path_data_diff_B5$est), by = 0.3), 1)) +
ggtitle("SAR5")
ggarrange(path_data_diff_B4_ggplot, path_data_diff_B5_ggplot,
labels = c("A", "B"),
ncol = 2)
path_data_diff_B5_ggplot <- ggplot(data = path_data_diff_B5, aes(x = est, y = pop_facet, color = effect_type)) +
geom_point() +
geom_errorbarh(aes(xmax = est + se, xmin = est - se), height = 0.3) +
geom_vline(xintercept = 0,
color = "black", size = 0.25) +
facet_wrap(~ trait_facet, nrow = 1) +
xlab("QTL effect") +
ylab("Population") +
theme(legend.text = element_text(size = 20),
legend.title = element_blank(),
axis.title = element_text(size = 20),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
plot.title = element_text(hjust = 0.5)) +
scale_x_continuous(breaks = round(seq(min(path_data_diff_B5$est), max(path_data_diff_B5$est), by = 0.3), 1)) +
ggtitle("SAR5")
ggarrange(path_data_diff_B4_ggplot, path_data_diff_B5_ggplot,
labels = c("A", "B"),
ncol = 2)
path_data_diff_B4 <- subset(path_data_FRI_FLC_ind, env == "diff" & allele_comb == "B4")
path_data_diff_B4_ggplot <- ggplot(data = path_data_diff_B4, aes(x = est, y = pop_facet, color = effect_type)) +
geom_point() +
geom_errorbarh(aes(xmax = est + se, xmin = est - se), height = 0.25) +
geom_vline(xintercept = 0,
color = "black", size = 0.25) +
facet_wrap(~ trait_facet, nrow = 1) +
xlab("QTL effect") +
ylab("Population") +
theme(legend.text = element_text(size = 20),
legend.title = element_blank(),
axis.title = element_text(size = 20),
axis.text.y = element_text(size = 20),
plot.title = element_text(hjust = 0.5),
legend.position = "none") +
ggtitle("SAR4")
path_data_diff_B5 <- subset(path_data_FRI_FLC_ind, env == "diff" & allele_comb == "B5")
path_data_diff_B5_ggplot <- ggplot(data = path_data_diff_B5, aes(x = est, y = pop_facet, color = effect_type)) +
geom_point() +
geom_errorbarh(aes(xmax = est + se, xmin = est - se), height = 0.25) +
geom_vline(xintercept = 0,
color = "black", size = 0.25) +
facet_wrap(~ trait_facet, nrow = 1) +
xlab("QTL effect") +
ylab("Population") +
theme(legend.text = element_text(size = 20),
legend.title = element_blank(),
axis.title = element_text(size = 20),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
plot.title = element_text(hjust = 0.5)) +
scale_x_continuous(breaks = round(seq(min(path_data_diff_B5$est), max(path_data_diff_B5$est), by = 0.3), 1)) +
ggtitle("SAR5")
ggarrange(path_data_diff_B4_ggplot, path_data_diff_B5_ggplot,
labels = c("A", "B"),
ncol = 2)
path_data_diff_B5_ggplot <- ggplot(data = path_data_diff_B5, aes(x = est, y = pop_facet, color = effect_type)) +
geom_point(aes(size = 0.2)) +
geom_errorbarh(aes(xmax = est + se, xmin = est - se), height = 0.25) +
geom_vline(xintercept = 0,
color = "black", size = 0.25) +
facet_wrap(~ trait_facet, nrow = 1) +
xlab("QTL effect") +
ylab("Population") +
theme(legend.text = element_text(size = 20),
legend.title = element_blank(),
axis.title = element_text(size = 20),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
plot.title = element_text(hjust = 0.5)) +
scale_x_continuous(breaks = round(seq(min(path_data_diff_B5$est), max(path_data_diff_B5$est), by = 0.3), 1)) +
ggtitle("SAR5")
ggarrange(path_data_diff_B4_ggplot, path_data_diff_B5_ggplot,
labels = c("A", "B"),
ncol = 2)
path_data_diff_B5_ggplot <- ggplot(data = path_data_diff_B5, aes(x = est, y = pop_facet, color = effect_type)) +
geom_point(aes(size = 0.1)) +
geom_errorbarh(aes(xmax = est + se, xmin = est - se), height = 0.25) +
geom_vline(xintercept = 0,
color = "black", size = 0.25) +
facet_wrap(~ trait_facet, nrow = 1) +
xlab("QTL effect") +
ylab("Population") +
theme(legend.text = element_text(size = 20),
legend.title = element_blank(),
axis.title = element_text(size = 20),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
plot.title = element_text(hjust = 0.5)) +
scale_x_continuous(breaks = round(seq(min(path_data_diff_B5$est), max(path_data_diff_B5$est), by = 0.3), 1)) +
ggtitle("SAR5")
ggarrange(path_data_diff_B4_ggplot, path_data_diff_B5_ggplot,
labels = c("A", "B"),
ncol = 2)
geom_point_size <- 30
path_data_diff_B4 <- subset(path_data_FRI_FLC_ind, env == "diff" & allele_comb == "B4")
path_data_diff_B4_ggplot <- ggplot(data = path_data_diff_B4, aes(x = est, y = pop_facet, color = effect_type)) +
geom_point(aes(size = geom_point_size)) +
geom_errorbarh(aes(xmax = est + se, xmin = est - se), height = 0.25) +
geom_vline(xintercept = 0,
color = "black", size = 0.25) +
facet_wrap(~ trait_facet, nrow = 1) +
xlab("QTL effect") +
ylab("Population") +
theme(legend.text = element_text(size = 20),
legend.title = element_blank(),
axis.title = element_text(size = 20),
axis.text.y = element_text(size = 20),
plot.title = element_text(hjust = 0.5),
legend.position = "none") +
ggtitle("SAR4")
path_data_diff_B5 <- subset(path_data_FRI_FLC_ind, env == "diff" & allele_comb == "B5")
path_data_diff_B5_ggplot <- ggplot(data = path_data_diff_B5, aes(x = est, y = pop_facet, color = effect_type)) +
geom_point(aes(size = geom_point_size)) +
geom_errorbarh(aes(xmax = est + se, xmin = est - se), height = 0.25) +
geom_vline(xintercept = 0,
color = "black", size = 0.25) +
facet_wrap(~ trait_facet, nrow = 1) +
xlab("QTL effect") +
ylab("Population") +
theme(legend.text = element_text(size = 20),
legend.title = element_blank(),
axis.title = element_text(size = 20),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
plot.title = element_text(hjust = 0.5)) +
scale_x_continuous(breaks = round(seq(min(path_data_diff_B5$est), max(path_data_diff_B5$est), by = 0.3), 1)) +
ggtitle("SAR5")
ggarrange(path_data_diff_B4_ggplot, path_data_diff_B5_ggplot,
labels = c("A", "B"),
ncol = 2)
path_data_diff_B4_ggplot <- ggplot(data = path_data_diff_B4, aes(x = est, y = pop_facet, color = effect_type)) +
geom_point(aes(size = geom_point_size)) +
geom_errorbarh(aes(xmax = est + se, xmin = est - se), height = 0.25, size = 2) +
geom_vline(xintercept = 0,
color = "black", size = 0.25) +
facet_wrap(~ trait_facet, nrow = 1) +
xlab("QTL effect") +
ylab("Population") +
theme(legend.text = element_text(size = 20),
legend.title = element_blank(),
axis.title = element_text(size = 20),
axis.text.y = element_text(size = 20),
plot.title = element_text(hjust = 0.5),
legend.position = "none") +
ggtitle("SAR4")
path_data_diff_B5 <- subset(path_data_FRI_FLC_ind, env == "diff" & allele_comb == "B5")
path_data_diff_B5_ggplot <- ggplot(data = path_data_diff_B5, aes(x = est, y = pop_facet, color = effect_type)) +
geom_point(aes(size = geom_point_size)) +
geom_errorbarh(aes(xmax = est + se, xmin = est - se), height = 0.25) +
geom_vline(xintercept = 0,
color = "black", size = 0.25) +
facet_wrap(~ trait_facet, nrow = 1) +
xlab("QTL effect") +
ylab("Population") +
theme(legend.text = element_text(size = 20),
legend.title = element_blank(),
axis.title = element_text(size = 20),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
plot.title = element_text(hjust = 0.5)) +
scale_x_continuous(breaks = round(seq(min(path_data_diff_B5$est), max(path_data_diff_B5$est), by = 0.3), 1)) +
ggtitle("SAR5")
ggarrange(path_data_diff_B4_ggplot, path_data_diff_B5_ggplot,
labels = c("A", "B"),
ncol = 2)
path_data_diff_B5_ggplot <- ggplot(data = path_data_diff_B5, aes(x = est, y = pop_facet, color = effect_type)) +
geom_point(aes(size = geom_point_size)) +
geom_errorbarh(aes(xmax = est + se, xmin = est - se), height = 0.25, size = 2) +
geom_vline(xintercept = 0,
color = "black", size = 0.25) +
facet_wrap(~ trait_facet, nrow = 1) +
xlab("QTL effect") +
ylab("Population") +
theme(legend.text = element_text(size = 20),
legend.title = element_blank(),
axis.title = element_text(size = 20),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
plot.title = element_text(hjust = 0.5)) +
scale_x_continuous(breaks = round(seq(min(path_data_diff_B5$est), max(path_data_diff_B5$est), by = 0.3), 1)) +
ggtitle("SAR5")
ggarrange(path_data_diff_B4_ggplot, path_data_diff_B5_ggplot,
labels = c("A", "B"),
ncol = 2)
path_data_diff_B4 <- subset(path_data_FRI_FLC_ind, env == "diff" & allele_comb == "B4")
path_data_diff_B4_ggplot <- ggplot(data = path_data_diff_B4, aes(x = est, y = pop_facet, color = effect_type)) +
geom_point() +
geom_errorbarh(aes(xmax = est + se, xmin = est - se), height = 0.25, size = 2) +
geom_vline(xintercept = 0,
color = "black", size = 0.25) +
facet_wrap(~ trait_facet, nrow = 1) +
xlab("QTL effect") +
ylab("Population") +
theme(legend.text = element_text(size = 20),
legend.title = element_blank(),
axis.title = element_text(size = 20),
axis.text.y = element_text(size = 20),
plot.title = element_text(hjust = 0.5),
legend.position = "none") +
ggtitle("SAR4")
path_data_diff_B5 <- subset(path_data_FRI_FLC_ind, env == "diff" & allele_comb == "B5")
path_data_diff_B5_ggplot <- ggplot(data = path_data_diff_B5, aes(x = est, y = pop_facet, color = effect_type)) +
geom_point() +
geom_errorbarh(aes(xmax = est + se, xmin = est - se), height = 0.25, size = 2) +
geom_vline(xintercept = 0,
color = "black", size = 0.25) +
facet_wrap(~ trait_facet, nrow = 1) +
xlab("QTL effect") +
ylab("Population") +
theme(legend.text = element_text(size = 20),
legend.title = element_blank(),
axis.title = element_text(size = 20),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
plot.title = element_text(hjust = 0.5)) +
scale_x_continuous(breaks = round(seq(min(path_data_diff_B5$est), max(path_data_diff_B5$est), by = 0.3), 1)) +
ggtitle("SAR5")
ggarrange(path_data_diff_B4_ggplot, path_data_diff_B5_ggplot,
labels = c("A", "B"),
ncol = 2)
path_data_diff_B5_ggplot <- ggplot(data = path_data_diff_B5, aes(x = est, y = pop_facet, color = effect_type)) +
geom_point(size = 0.1) +
geom_errorbarh(aes(xmax = est + se, xmin = est - se), height = 0.25, size = 2) +
geom_vline(xintercept = 0,
color = "black", size = 0.25) +
facet_wrap(~ trait_facet, nrow = 1) +
xlab("QTL effect") +
ylab("Population") +
theme(legend.text = element_text(size = 20),
legend.title = element_blank(),
axis.title = element_text(size = 20),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
plot.title = element_text(hjust = 0.5)) +
scale_x_continuous(breaks = round(seq(min(path_data_diff_B5$est), max(path_data_diff_B5$est), by = 0.3), 1)) +
ggtitle("SAR5")
ggarrange(path_data_diff_B4_ggplot, path_data_diff_B5_ggplot,
labels = c("A", "B"),
ncol = 2)
path_data_diff_B5_ggplot <- ggplot(data = path_data_diff_B5, aes(x = est, y = pop_facet, color = effect_type)) +
geom_point(size = 0.5) +
geom_errorbarh(aes(xmax = est + se, xmin = est - se), height = 0.25, size = 2) +
geom_vline(xintercept = 0,
color = "black", size = 0.25) +
facet_wrap(~ trait_facet, nrow = 1) +
xlab("QTL effect") +
ylab("Population") +
theme(legend.text = element_text(size = 20),
legend.title = element_blank(),
axis.title = element_text(size = 20),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
plot.title = element_text(hjust = 0.5)) +
scale_x_continuous(breaks = round(seq(min(path_data_diff_B5$est), max(path_data_diff_B5$est), by = 0.3), 1)) +
ggtitle("SAR5")
ggarrange(path_data_diff_B4_ggplot, path_data_diff_B5_ggplot,
labels = c("A", "B"),
ncol = 2)
path_data_diff_B5_ggplot
path_data_diff_B5_ggplot <- ggplot(data = path_data_diff_B5, aes(x = est, y = pop_facet, color = effect_type)) +
geom_point(size = 5) +
geom_errorbarh(aes(xmax = est + se, xmin = est - se), height = 0.25, size = 2) +
geom_vline(xintercept = 0,
color = "black", size = 0.25) +
facet_wrap(~ trait_facet, nrow = 1) +
xlab("QTL effect") +
ylab("Population") +
theme(legend.text = element_text(size = 20),
legend.title = element_blank(),
axis.title = element_text(size = 20),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
plot.title = element_text(hjust = 0.5)) +
scale_x_continuous(breaks = round(seq(min(path_data_diff_B5$est), max(path_data_diff_B5$est), by = 0.3), 1)) +
ggtitle("SAR5")
ggarrange(path_data_diff_B4_ggplot, path_data_diff_B5_ggplot,
labels = c("A", "B"),
ncol = 2)
path_data_diff_B4_ggplot <- ggplot(data = path_data_diff_B4, aes(x = est, y = pop_facet, color = effect_type)) +
geom_point(size = 3) +
geom_errorbarh(aes(xmax = est + se, xmin = est - se), height = 0.25, size = 2) +
geom_vline(xintercept = 0,
color = "black", size = 0.25) +
facet_wrap(~ trait_facet, nrow = 1) +
xlab("QTL effect") +
ylab("Population") +
theme(legend.text = element_text(size = 20),
legend.title = element_blank(),
axis.title = element_text(size = 20),
axis.text.y = element_text(size = 20),
plot.title = element_text(hjust = 0.5),
legend.position = "none") +
ggtitle("SAR4")
path_data_diff_B5 <- subset(path_data_FRI_FLC_ind, env == "diff" & allele_comb == "B5")
path_data_diff_B5_ggplot <- ggplot(data = path_data_diff_B5, aes(x = est, y = pop_facet, color = effect_type)) +
geom_point(size = 3) +
geom_errorbarh(aes(xmax = est + se, xmin = est - se), height = 0.25, size = 2) +
geom_vline(xintercept = 0,
color = "black", size = 0.25) +
facet_wrap(~ trait_facet, nrow = 1) +
xlab("QTL effect") +
ylab("Population") +
theme(legend.text = element_text(size = 20),
legend.title = element_blank(),
axis.title = element_text(size = 20),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
plot.title = element_text(hjust = 0.5)) +
scale_x_continuous(breaks = round(seq(min(path_data_diff_B5$est), max(path_data_diff_B5$est), by = 0.3), 1)) +
ggtitle("SAR5")
ggarrange(path_data_diff_B4_ggplot, path_data_diff_B5_ggplot,
labels = c("A", "B"),
ncol = 2)
path_data_diff_B4_ggplot <- ggplot(data = path_data_diff_B4, aes(x = est, y = pop_facet, color = effect_type)) +
geom_point(size = 4) +
geom_errorbarh(aes(xmax = est + se, xmin = est - se), height = 0.25, size = 2) +
geom_vline(xintercept = 0,
color = "black", size = 0.25) +
facet_wrap(~ trait_facet, nrow = 1) +
xlab("QTL effect") +
ylab("Population") +
theme(legend.text = element_text(size = 20),
legend.title = element_blank(),
axis.title = element_text(size = 20),
axis.text.y = element_text(size = 20),
plot.title = element_text(hjust = 0.5),
legend.position = "none") +
ggtitle("SAR4")
path_data_diff_B5 <- subset(path_data_FRI_FLC_ind, env == "diff" & allele_comb == "B5")
path_data_diff_B5_ggplot <- ggplot(data = path_data_diff_B5, aes(x = est, y = pop_facet, color = effect_type)) +
geom_point(size = 4) +
geom_errorbarh(aes(xmax = est + se, xmin = est - se), height = 0.25, size = 2) +
geom_vline(xintercept = 0,
color = "black", size = 0.25) +
facet_wrap(~ trait_facet, nrow = 1) +
xlab("QTL effect") +
ylab("Population") +
theme(legend.text = element_text(size = 20),
legend.title = element_blank(),
axis.title = element_text(size = 20),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
plot.title = element_text(hjust = 0.5)) +
scale_x_continuous(breaks = round(seq(min(path_data_diff_B5$est), max(path_data_diff_B5$est), by = 0.3), 1)) +
ggtitle("SAR5")
ggarrange(path_data_diff_B4_ggplot, path_data_diff_B5_ggplot,
labels = c("A", "B"),
ncol = 2)
ggsave("SAR4_SAR5_effect_comparison.png", device = "png")
setwd("/Users/James/Documents/GitHub/sar_qtl/7_path_analysis/output/")
ggsave("SAR4_SAR5_effect_comparison.png", device = "png")
setwd("/Users/James/Documents/GitHub/sar_qtl/figures/path_analysis_figures/")
ggsave("SAR4_SAR5_effect_comparison.png", device = "png")
ggsave("SAR4_SAR5_effect_comparison.png", device = "png", width = 10, height - 6)
setwd("/Users/James/Documents/GitHub/sar_qtl/figures/path_analysis_figures/")
ggsave("SAR4_SAR5_effect_comparison.png", device = "png", width = 10, height = 6)
ggsave("SAR4_SAR5_effect_comparison.png", device = "png", width = 12, height = 6)
setwd("/Users/James/Documents/GitHub/sar_qtl/figures/path_analysis_figures/")
ggsave("SAR4_SAR5_effect_comparison.png", device = "png", width = 15, height = 6)
library(ggpubr)
library(png)
rm(list = ls())
setwd("/Users/James/Documents/GitHub/sar_qtl/figures/qtl_ci_linkage_map/")
bd_geno_no_cov <- readPNG("gxe_qtl_linkage_no_cov.png")
bd_geno_cov <- readPNG("gxe_qtl_linkage_cov.png")
im_A <- ggplot() +
background_image(bd_geno_no_cov) +
# This ensures that the image leaves some space at the edges
theme(plot.margin = margin(t=1, l=1, r=1, b=1, unit = "cm"))
im_B <- ggplot() + background_image(bd_geno_cov) +
theme(plot.margin = margin(t=1, l=1, r=1, b=1, unit = "cm"))
ggarrange(im_A, im_B,
labels = c("A", "B"),
ncol = 2)
bd_geno_no_cov <- readPNG("gxe_qtl_linkage_no_cov_rotated.png")
bd_geno_cov <- readPNG("gxe_qtl_linkage_cov_rotated.png")
im_A <- ggplot() +
background_image(bd_geno_no_cov) +
# This ensures that the image leaves some space at the edges
theme(plot.margin = margin(t=1, l=1, r=1, b=1, unit = "cm"))
im_B <- ggplot() + background_image(bd_geno_cov) +
theme(plot.margin = margin(t=1, l=1, r=1, b=1, unit = "cm"))
ggarrange(im_A, im_B,
labels = c("A", "B"),
ncol = 2)
ggsave("gxe_qtl_linkage_no_cov_vs_cov_compared.png", device = "png", height = 8, width = 15)
bd_geno_no_cov <- readPNG("gxe_qtl_linkage_no_cov_rotated.png", bg = "transparent")
bd_geno_cov <- readPNG("gxe_qtl_linkage_cov_rotated.png", bg = "transparent")
bd_geno_no_cov <- png("gxe_qtl_linkage_no_cov_rotated.png", bg = "transparent")
bd_geno_cov <- png("gxe_qtl_linkage_cov_rotated.png", bg = "transparent")
im_A <- ggplot() +
background_image(bd_geno_no_cov) +
# This ensures that the image leaves some space at the edges
theme(plot.margin = margin(t=1, l=1, r=1, b=1, unit = "cm"))
bd_geno_no_cov <- readPNG("gxe_qtl_linkage_no_cov_rotated.png")
bd_geno_cov <- readPNG("gxe_qtl_linkage_cov_rotated.png")
im_A <- ggplot() +
background_image(bd_geno_no_cov) +
# This ensures that the image leaves some space at the edges
theme(plot.margin = margin(t=1, l=1, r=1, b=1, unit = "cm"))
im_B <- ggplot() + background_image(bd_geno_cov) +
theme(plot.margin = margin(t=1, l=1, r=1, b=1, unit = "cm"))
setwd("/Users/James/Documents/GitHub/sar_qtl/figures/qtl_ci_linkage_map/")
bd_geno_no_cov <- readPNG("gxe_qtl_linkage_no_cov_rotated.png")
setwd("/Users/James/Documents/GitHub/sar_qtl/figures/qtl_ci_linkage_map/")
bd_geno_no_cov <- readPNG("gxe_qtl_linkage_no_cov_rotated.png")
bd_geno_cov <- readPNG("gxe_qtl_linkage_cov_rotated.png")
im_A <- ggplot() +
background_image(bd_geno_no_cov) +
# This ensures that the image leaves some space at the edges
theme(plot.margin = margin(t=1, l=1, r=1, b=1, unit = "cm"))
im_B <- ggplot() + background_image(bd_geno_cov) +
theme(plot.margin = margin(t=1, l=1, r=1, b=1, unit = "cm"))
ggarrange(im_A, im_B,
labels = c("A", "B"),
ncol = 2)
ggsave("gxe_qtl_linkage_no_cov_vs_cov_compared.png", device = "png", height = 8, width = 15, bd = "transparent")
ggsave("gxe_qtl_linkage_no_cov_vs_cov_compared.png", device = "png", height = 8, width = 15, bg = "transparent")
im_A
im_A <- ggplot() +
background_image(bd_geno_no_cov) +
# This ensures that the image leaves some space at the edges
theme(plot.margin = margin(t=1, l=1, r=1, b=1, unit = "cm"),
panel.background = element_rect(fill = "transparent"), # bg of the panel
plot.background = element_rect(fill = "transparent", color = NA), # bg of the plot
panel.grid.major = element_blank(), # get rid of major grid
panel.grid.minor = element_blank(), # get rid of minor grid
legend.background = element_rect(fill = "transparent"), # get rid of legend bg
legend.box.background = element_rect(fill = "transparent"))
im_B <- ggplot() + background_image(bd_geno_cov) +
theme(plot.margin = margin(t=1, l=1, r=1, b=1, unit = "cm"),
panel.background = element_rect(fill = "transparent"), # bg of the panel
plot.background = element_rect(fill = "transparent", color = NA), # bg of the plot
panel.grid.major = element_blank(), # get rid of major grid
panel.grid.minor = element_blank(), # get rid of minor grid
legend.background = element_rect(fill = "transparent"), # get rid of legend bg
legend.box.background = element_rect(fill = "transparent"))
ggarrange(im_A, im_B,
labels = c("A", "B"),
ncol = 2)
ggarrange(im_A, im_B,
labels = c("A", "B"),
ncol = 2)
ggsave("gxe_qtl_linkage_no_cov_vs_cov_compared.png", device = "png", height = 8, width = 15, bg = "transparent")
