#this script will generate a plot for the linkage map comparing the covariate vs. no covariate methods
library(ggpubr)
library(png)
rm(list = ls())
setwd("/Users/James/Documents/GitHub/sar_qtl/figures/path_average_model/")
average_path_sun <- readPNG("path_average_sun_model.png")
average_path_shade <- readPNG("path_average_shade_model.png")
im_A <- ggplot() +
background_image(average_path_sun) +
# This ensures that the image leaves some space at the edges
theme(plot.margin = margin(t=1, l=1, r=1, b=1, unit = "cm"),
panel.background = element_rect(fill = "transparent"), # bg of the panel
plot.background = element_rect(fill = "transparent", color = NA), # bg of the plot
panel.grid.major = element_blank(), # get rid of major grid
panel.grid.minor = element_blank(), # get rid of minor grid
legend.background = element_rect(fill = "transparent"), # get rid of legend bg
legend.box.background = element_rect(fill = "transparent"))
im_B <- ggplot() + background_image(average_path_shade) +
theme(plot.margin = margin(t=1, l=1, r=1, b=1, unit = "cm"),
panel.background = element_rect(fill = "transparent"), # bg of the panel
plot.background = element_rect(fill = "transparent", color = NA), # bg of the plot
panel.grid.major = element_blank(), # get rid of major grid
panel.grid.minor = element_blank(), # get rid of minor grid
legend.background = element_rect(fill = "transparent"), # get rid of legend bg
legend.box.background = element_rect(fill = "transparent"))
ggarrange(im_A, im_B,
labels = c("A", "B"),
nrow = 2,
font.label = list(size = 65))
ggarrange(im_A, im_B,
labels = c("A", "B"),
nrow = 2,
font.label = list(size = 55))
ggsave("sun_vs_shade_average_path_model.png", device = "png", height = 20, width = 12, bg = "transparent")
#script to merge and plot direct and indirect effects
library(data.table)
library(ggplot2)
library(ggpubr)
library(plyr)
rm(list = ls())
setwd("/Users/James/Documents/GitHub/sar_qtl/7_path_analysis/output/")
path_data <- rbindlist(lapply(list.files(pattern = "path_eff_FRIFLC.csv"),
function(x) fread(x, sep = ",", header = TRUE, stringsAsFactors = FALSE)))
path_data$pop_facet <- factor(path_data$pop, levels = c("sha", "oy", "jea", "ita", "cvi", "bur", "blh"))
path_data$trait_facet <- factor(path_data$trait, levels = c("bd", "rdry", "h3h1", "idry"))
#looking at fri and flc individually
path_data_FRI_FLC_ind <- rbindlist(lapply(list.files(pattern = "path_eff_alt.csv"),
function(x) fread(x, sep = ",", header = TRUE, stringsAsFactors = FALSE)))
path_data_FRI_FLC_ind$pop <- revalue(path_data_FRI_FLC_ind$pop, c("sha" = "Sha", "oy" = "Oy-0", "jea" = "Jea", "ita" = "Ita-0", "cvi" = "Cvi-0", "bur" = "Bur-0", "blh" = "Blh-1"))
path_data_FRI_FLC_ind$pop_facet <- factor(path_data_FRI_FLC_ind$pop, levels = c("sha" = "Sha", "oy" = "Oy-0", "jea" = "Jea", "ita" = "Ita-0", "cvi" = "Cvi-0", "bur" = "Bur-0", "blh" = "Blh-1"))
path_data_FRI_FLC_ind$trait_facet <- factor(path_data_FRI_FLC_ind$trait, levels = c("bd", "rdry", "h3h1", "idry"))
path_data_FRI_FLC_ind$effect_type <- revalue(path_data_FRI_FLC_ind$effect_type, c("dir" = "Direct", "ind" = "Indirect"))
geom_point_size <- 30
geom_point_size <- 30
path_data_diff_B42 <- subset(path_data_FRI_FLC_ind, env == "diff" & allele_comb == "B42")
path_data_diff_B42[path_data_diff_B42 == 0] <- NA
path_data_diff_B42_ggplot <- ggplot(data = path_data_diff_B42, aes(x = est, y = pop_facet, color = effect_type)) +
geom_point(size = 4) +
geom_errorbarh(aes(xmax = est + se, xmin = est - se), height = 0.25, size = 2) +
geom_vline(xintercept = 0,
color = "black", size = 0.25) +
facet_wrap(~ trait_facet, nrow = 1) +
xlab("QTL effect") +
ylab("Population") +
theme(legend.text = element_text(size = 20),
legend.title = element_blank(),
axis.title = element_text(size = 20),
axis.text.y = element_text(size = 20),
plot.title = element_text(hjust = 0.5, size = 20),
legend.position = "none") +
ggtitle("m_4_41028")
path_data_diff_B42_ggplot
path_data_diff_B42_ggplot <- ggplot(data = path_data_diff_B42, aes(x = est, y = pop_facet, color = effect_type)) +
geom_point(size = 4) +
geom_errorbarh(aes(xmax = est + se, xmin = est - se), height = 0.25, size = 2) +
geom_vline(xintercept = 0,
color = "black", size = 0.25) +
facet_wrap(~ trait_facet, nrow = 1) +
xlab("QTL effect") +
ylab("Population") +
theme(legend.text = element_text(size = 20),
legend.title = element_blank(),
axis.title = element_text(size = 20),
axis.text.y = element_text(size = 20),
plot.title = element_text(hjust = 0.5, size = 20),
legend.position = "none") +
ggtitle("m_4_9222034")
path_data_diff_B42_ggplot
setwd("/Users/James/Documents/GitHub/sar_qtl/figures/path_analysis_figures/")
ggsave("SAR42_effect_comparison.png", device = "png", width = 8, height = 6)
#script to merge and plot direct and indirect effects
library(data.table)
library(ggplot2)
library(ggpubr)
library(plyr)
rm(list = ls())
setwd("/Users/James/Documents/GitHub/sar_qtl/7_path_analysis/output/")
path_data <- rbindlist(lapply(list.files(pattern = "path_eff_FRIFLC.csv"),
function(x) fread(x, sep = ",", header = TRUE, stringsAsFactors = FALSE)))
path_data$pop_facet <- factor(path_data$pop, levels = c("sha", "oy", "jea", "ita", "cvi", "bur", "blh"))
path_data$trait_facet <- factor(path_data$trait, levels = c("bd", "rdry", "h3h1", "idry"))
#looking at fri and flc individually
path_data_FRI_FLC_ind <- rbindlist(lapply(list.files(pattern = "path_eff_alt.csv"),
function(x) fread(x, sep = ",", header = TRUE, stringsAsFactors = FALSE)))
path_data_FRI_FLC_ind$pop <- revalue(path_data_FRI_FLC_ind$pop, c("sha" = "Sha", "oy" = "Oy-0", "jea" = "Jea", "ita" = "Ita-0", "cvi" = "Cvi-0", "bur" = "Bur-0", "blh" = "Blh-1"))
path_data_FRI_FLC_ind$pop_facet <- factor(path_data_FRI_FLC_ind$pop, levels = c("sha" = "Sha", "oy" = "Oy-0", "jea" = "Jea", "ita" = "Ita-0", "cvi" = "Cvi-0", "bur" = "Bur-0", "blh" = "Blh-1"))
path_data_FRI_FLC_ind$trait_facet <- factor(path_data_FRI_FLC_ind$trait, levels = c("bd", "rdry", "h3h1", "idry"))
path_data_FRI_FLC_ind$effect_type <- revalue(path_data_FRI_FLC_ind$effect_type, c("dir" = "Direct", "ind" = "Indirect"))
geom_point_size <- 30
path_data_diff_B4 <- subset(path_data_FRI_FLC_ind, env == "diff" & allele_comb == "B4")
path_data_diff_B4[path_data_diff_B4 == 0] <- NA
path_data_diff_B4_ggplot <- ggplot(data = path_data_diff_B4, aes(x = est, y = pop_facet, color = effect_type)) +
geom_point(size = 4) +
geom_errorbarh(aes(xmax = est + se, xmin = est - se), height = 0.25, size = 2) +
geom_vline(xintercept = 0,
color = "black", size = 0.25) +
facet_wrap(~ trait_facet, nrow = 1) +
xlab("QTL effect") +
ylab("Population") +
theme(legend.text = element_text(size = 20),
legend.title = element_blank(),
axis.title = element_text(size = 20),
axis.text.y = element_text(size = 20),
plot.title = element_text(hjust = 0.5, size = 20),
legend.position = "none") +
ggtitle("m_4_41028")
path_data_diff_B5 <- subset(path_data_FRI_FLC_ind, env == "diff" & allele_comb == "B5")
path_data_diff_B5[path_data_diff_B5 == 0] <- NA
path_data_diff_B5_ggplot <- ggplot(data = path_data_diff_B5, aes(x = est, y = pop_facet, color = effect_type)) +
geom_point(size = 4) +
geom_errorbarh(aes(xmax = est + se, xmin = est - se), height = 0.25, size = 2) +
geom_vline(xintercept = 0,
color = "black", size = 0.25) +
facet_wrap(~ trait_facet, nrow = 1) +
xlab("QTL effect") +
ylab("Population") +
theme(legend.text = element_text(size = 20),
legend.title = element_blank(),
axis.title = element_text(size = 20),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
plot.title = element_text(hjust = 0.5, size = 20)) +
scale_x_continuous(breaks = round(seq(min(path_data_diff_B5$est, na.rm = TRUE), max(path_data_diff_B5$est, na.rm = TRUE), by = 0.3), 1)) +
ggtitle("m_5_3799350")
path_data_diff_B42 <- subset(path_data_FRI_FLC_ind, env == "diff" & allele_comb == "B42")
path_data_diff_B42[path_data_diff_B42 == 0] <- NA
path_data_diff_B42_ggplot <- ggplot(data = path_data_diff_B42, aes(x = est, y = pop_facet, color = effect_type)) +
geom_point(size = 4) +
geom_errorbarh(aes(xmax = est + se, xmin = est - se), height = 0.25, size = 2) +
geom_vline(xintercept = 0,
color = "black", size = 0.25) +
facet_wrap(~ trait_facet, nrow = 1) +
xlab("QTL effect") +
ylab("Population") +
theme(legend.text = element_text(size = 20),
legend.title = element_blank(),
axis.title = element_text(size = 20),
axis.text.y = element_text(size = 20),
plot.title = element_text(hjust = 0.5, size = 20),
legend.position = "none") +
ggtitle("m_4_9222034")
ggarrange(path_data_diff_B4_ggplot, path_data_diff_B5_ggplot, path_data_diff_B42_ggplot,
labels = c("A", "B", "C"),
font.label = list(size = 40),
nrow = 2)
ggarrange(path_data_diff_B4_ggplot, path_data_diff_B5_ggplot, path_data_diff_B42_ggplot,
labels = c("A", "B", "C"),
font.label = list(size = 40))
ggarrange(path_data_diff_B4_ggplot, path_data_diff_B5_ggplot, path_data_diff_B42_ggplot,
labels = c("A", "B", "C"),
font.label = list(size = 30))
#script to merge and plot direct and indirect effects
library(data.table)
library(ggplot2)
library(ggpubr)
library(plyr)
rm(list = ls())
setwd("/Users/James/Documents/GitHub/sar_qtl/7_path_analysis/output/")
path_data <- rbindlist(lapply(list.files(pattern = "path_eff_FRIFLC.csv"),
function(x) fread(x, sep = ",", header = TRUE, stringsAsFactors = FALSE)))
path_data$pop_facet <- factor(path_data$pop, levels = c("sha", "oy", "jea", "ita", "cvi", "bur", "blh"))
path_data$trait_facet <- factor(path_data$trait, levels = c("bd", "rdry", "h3h1", "idry"))
#looking at fri and flc individually
path_data_FRI_FLC_ind <- rbindlist(lapply(list.files(pattern = "path_eff_alt.csv"),
function(x) fread(x, sep = ",", header = TRUE, stringsAsFactors = FALSE)))
path_data_FRI_FLC_ind$pop <- revalue(path_data_FRI_FLC_ind$pop, c("sha" = "Sha", "oy" = "Oy-0", "jea" = "Jea", "ita" = "Ita-0", "cvi" = "Cvi-0", "bur" = "Bur-0", "blh" = "Blh-1"))
path_data_FRI_FLC_ind$pop_facet <- factor(path_data_FRI_FLC_ind$pop, levels = c("sha" = "Sha", "oy" = "Oy-0", "jea" = "Jea", "ita" = "Ita-0", "cvi" = "Cvi-0", "bur" = "Bur-0", "blh" = "Blh-1"))
path_data_FRI_FLC_ind$trait_facet <- factor(path_data_FRI_FLC_ind$trait, levels = c("bd", "rdry", "h3h1", "idry"))
path_data_FRI_FLC_ind$effect_type <- revalue(path_data_FRI_FLC_ind$effect_type, c("dir" = "Direct", "ind" = "Indirect"))
geom_point_size <- 30
path_data_diff_B4 <- subset(path_data_FRI_FLC_ind, env == "diff" & allele_comb == "B4")
path_data_diff_B4[path_data_diff_B4 == 0] <- NA
path_data_diff_B4_ggplot <- ggplot(data = path_data_diff_B4, aes(x = est, y = pop_facet, color = effect_type)) +
geom_point(size = 4) +
geom_errorbarh(aes(xmax = est + se, xmin = est - se), height = 0.25, size = 2) +
geom_vline(xintercept = 0,
color = "black", size = 0.25) +
facet_wrap(~ trait_facet, nrow = 1) +
xlab("QTL effect") +
ylab("Population") +
theme(legend.text = element_text(size = 20),
legend.title = element_blank(),
axis.title = element_text(size = 20),
axis.text.y = element_text(size = 20),
plot.title = element_text(hjust = 0.5, size = 20),
legend.position = "none") +
ggtitle("m_4_41028")
path_data_diff_B42 <- subset(path_data_FRI_FLC_ind, env == "diff" & allele_comb == "B42")
path_data_diff_B42[path_data_diff_B42 == 0] <- NA
path_data_diff_B42_ggplot <- ggplot(data = path_data_diff_B42, aes(x = est, y = pop_facet, color = effect_type)) +
geom_point(size = 4) +
geom_errorbarh(aes(xmax = est + se, xmin = est - se), height = 0.25, size = 2) +
geom_vline(xintercept = 0,
color = "black", size = 0.25) +
facet_wrap(~ trait_facet, nrow = 1) +
xlab("QTL effect") +
ylab("Population") +
theme(legend.text = element_text(size = 20),
legend.title = element_blank(),
axis.title = element_text(size = 20),
axis.text.y = element_text(size = 20),
plot.title = element_text(hjust = 0.5, size = 20),
legend.position = "none") +
ggtitle("m_4_9222034")
path_data_diff_B5 <- subset(path_data_FRI_FLC_ind, env == "diff" & allele_comb == "B5")
path_data_diff_B5[path_data_diff_B5 == 0] <- NA
path_data_diff_B5_ggplot <- ggplot(data = path_data_diff_B5, aes(x = est, y = pop_facet, color = effect_type)) +
geom_point(size = 4) +
geom_errorbarh(aes(xmax = est + se, xmin = est - se), height = 0.25, size = 2) +
geom_vline(xintercept = 0,
color = "black", size = 0.25) +
facet_wrap(~ trait_facet, nrow = 1) +
xlab("QTL effect") +
ylab("Population") +
theme(legend.text = element_text(size = 20),
legend.title = element_blank(),
axis.title = element_text(size = 20),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
plot.title = element_text(hjust = 0.5, size = 20)) +
scale_x_continuous(breaks = round(seq(min(path_data_diff_B5$est, na.rm = TRUE), max(path_data_diff_B5$est, na.rm = TRUE), by = 0.3), 1)) +
ggtitle("m_5_3799350")
ggarrange(path_data_diff_B4_ggplot, path_data_diff_B5_ggplot, path_data_diff_B42_ggplot,
labels = c("A", "B", "C"),
font.label = list(size = 30))
setwd("/Users/James/Documents/GitHub/sar_qtl/figures/path_analysis_figures/")
ggsave("SAR4_SAR42_SAR5_effect_comparison.png", device = "png", width = 15, height = 12)
setwd("/Users/James/Documents/GitHub/sar_qtl/figures/path_analysis_figures/")
ggsave("SAR4_SAR42_SAR5_effect_comparison.png", device = "png", width = 20, height = 12)
ggsave("SAR4_SAR42_SAR5_effect_comparison.png", device = "png", width = 15, height = 14)
ggsave("SAR4_SAR42_SAR5_effect_comparison.png", device = "png", width = 15, height = 12)
ggsave("SAR4_SAR42_SAR5_effect_comparison.png", device = "png", width = 15, height = 12)
ggarrange(path_data_diff_B4_ggplot, path_data_diff_B42_ggplot, path_data_diff_B5_ggplot,
labels = c("A", "B", "C"),
font.label = list(size = 30))
path_data_diff_B42_ggplot <- ggplot(data = path_data_diff_B42, aes(x = est, y = pop_facet, color = effect_type)) +
geom_point(size = 4) +
geom_errorbarh(aes(xmax = est + se, xmin = est - se), height = 0.25, size = 2) +
geom_vline(xintercept = 0,
color = "black", size = 0.25) +
facet_wrap(~ trait_facet, nrow = 1) +
xlab("QTL effect") +
ylab("Population") +
theme(legend.text = element_text(size = 20),
legend.title = element_blank(),
axis.title = element_text(size = 20),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
plot.title = element_text(hjust = 0.5, size = 20)) +
ggtitle("m_4_9222034")
path_data_diff_B5_ggplot <- ggplot(data = path_data_diff_B5, aes(x = est, y = pop_facet, color = effect_type)) +
geom_point(size = 4) +
geom_errorbarh(aes(xmax = est + se, xmin = est - se), height = 0.25, size = 2) +
geom_vline(xintercept = 0,
color = "black", size = 0.25) +
facet_wrap(~ trait_facet, nrow = 1) +
xlab("QTL effect") +
ylab("Population") +
theme(legend.text = element_text(size = 20),
legend.title = element_blank(),
axis.title = element_text(size = 20),
axis.text.y = element_text(size = 20),
plot.title = element_text(hjust = 0.5, size = 20),
legend.position = "none") +
scale_x_continuous(breaks = round(seq(min(path_data_diff_B5$est, na.rm = TRUE), max(path_data_diff_B5$est, na.rm = TRUE), by = 0.3), 1)) +
ggtitle("m_5_3799350")
ggarrange(path_data_diff_B4_ggplot, path_data_diff_B42_ggplot, path_data_diff_B5_ggplot,
labels = c("A", "B", "C"),
font.label = list(size = 30))
ggsave("SAR4_SAR42_SAR5_effect_comparison.png", device = "png", width = 15, height = 12)
ggarrange(path_data_diff_B4_ggplot, path_data_diff_B42_ggplot, path_data_diff_B5_ggplot,
label.y = 1.5,
labels = c("A", "B", "C"),
font.label = list(size = 30))
ggarrange(path_data_diff_B4_ggplot, path_data_diff_B42_ggplot, path_data_diff_B5_ggplot,
label.y = 1.1,
labels = c("A", "B", "C"),
font.label = list(size = 30))
ggarrange(path_data_diff_B4_ggplot, path_data_diff_B42_ggplot, path_data_diff_B5_ggplot,
label.y = 1.05,
labels = c("A", "B", "C"),
font.label = list(size = 30))
ggarrange(path_data_diff_B4_ggplot, path_data_diff_B42_ggplot, path_data_diff_B5_ggplot,
label.y = rep(1.05, 3),
labels = c("A", "B", "C"),
font.label = list(size = 30))
ggarrange(path_data_diff_B4_ggplot, path_data_diff_B42_ggplot, path_data_diff_B5_ggplot,
label.y = 1,
labels = c("A", "B", "C"),
font.label = list(size = 30))
ggarrange(path_data_diff_B4_ggplot, path_data_diff_B42_ggplot, path_data_diff_B5_ggplot,
vjust = 1.4,
labels = c("A", "B", "C"),
font.label = list(size = 30))
ggarrange(path_data_diff_B4_ggplot, path_data_diff_B42_ggplot, path_data_diff_B5_ggplot,
vjust = 1.25,
labels = c("A", "B", "C"),
font.label = list(size = 30))
ggarrange(path_data_diff_B4_ggplot, path_data_diff_B42_ggplot, path_data_diff_B5_ggplot,
vjust = 1.1,
labels = c("A", "B", "C"),
font.label = list(size = 30))
ggsave("SAR4_SAR42_SAR5_effect_comparison.png", device = "png", width = 15, height = 12)
ggarrange(path_data_diff_B4_ggplot, path_data_diff_B42_ggplot, path_data_diff_B5_ggplot,
vjust = 1.1,
hjust = c(0, -0.5, 0),
labels = c("A", "B", "C"),
font.label = list(size = 30))
ggarrange(path_data_diff_B4_ggplot, path_data_diff_B42_ggplot, path_data_diff_B5_ggplot,
vjust = 1.1,
hjust = c(-1, -0.5, -1),
labels = c("A", "B", "C"),
font.label = list(size = 30))
ggarrange(path_data_diff_B4_ggplot, path_data_diff_B42_ggplot, path_data_diff_B5_ggplot,
vjust = 1.1,
hjust = c(-2, -0.5, -2),
labels = c("A", "B", "C"),
font.label = list(size = 30))
ggarrange(path_data_diff_B4_ggplot, path_data_diff_B42_ggplot, path_data_diff_B5_ggplot,
vjust = 1.1,
hjust = c(-4, -0.5, -4),
labels = c("A", "B", "C"),
font.label = list(size = 30))
ggarrange(path_data_diff_B4_ggplot, path_data_diff_B42_ggplot, path_data_diff_B5_ggplot,
vjust = 1.1,
hjust = c(-5, -0.5, -4),
labels = c("A", "B", "C"),
font.label = list(size = 30))
ggarrange(path_data_diff_B4_ggplot, path_data_diff_B42_ggplot, path_data_diff_B5_ggplot,
vjust = 1.1,
hjust = c(-4.5, -0.5, -4),
labels = c("A", "B", "C"),
font.label = list(size = 30))
ggsave("SAR4_SAR42_SAR5_effect_comparison.png", device = "png", width = 15, height = 12)
ggarrange(path_data_diff_B4_ggplot, path_data_diff_B5_ggplot,
labels = c("A", "B"),
font.label = list(size = 30))
path_data_diff_B5_ggplot <- ggplot(data = path_data_diff_B5, aes(x = est, y = pop_facet, color = effect_type)) +
geom_point(size = 4) +
geom_errorbarh(aes(xmax = est + se, xmin = est - se), height = 0.25, size = 2) +
geom_vline(xintercept = 0,
color = "black", size = 0.25) +
facet_wrap(~ trait_facet, nrow = 1) +
xlab("QTL effect") +
ylab("Population") +
theme(legend.text = element_text(size = 20),
legend.title = element_blank(),
axis.title = element_text(size = 20),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
plot.title = element_text(hjust = 0.5, size = 20)) +
scale_x_continuous(breaks = round(seq(min(path_data_diff_B5$est, na.rm = TRUE), max(path_data_diff_B5$est, na.rm = TRUE), by = 0.3), 1)) +
ggtitle("m_5_3799350")
setwd("/Users/James/Documents/GitHub/sar_qtl/figures/path_analysis_figures/")
ggarrange(path_data_diff_B4_ggplot, path_data_diff_B5_ggplot,
labels = c("A", "B"),
font.label = list(size = 30))
ggarrange(path_data_diff_B4_ggplot, path_data_diff_B5_ggplot,
vjust = 1.1,
hjust = c(-4.5, -0.5),
labels = c("A", "B"),
font.label = list(size = 30))
ggsave("SAR4_SAR5_effect_comparison.png", device = "png", width = 15, height = 12)
ggarrange(path_data_diff_B4_ggplot, path_data_diff_B5_ggplot,
vjust = 1.1,
hjust = c(-4.5, -0.5),
labels = c("A", "B"),
font.label = list(size = 30))
ggsave("SAR4_SAR5_effect_comparison.png", device = "png", width = 15, height = 6)
