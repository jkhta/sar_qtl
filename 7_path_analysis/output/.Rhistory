#model wih individual components of volume
dens_0 <- lm(rings ~ sex + vol + whole_weight, data = aba)
dens_1 <- lm(rings ~ sex + density, data = aba)
aba$vol <- with(data = aba, length * diameter * height)
aba$dens <- with(data = aba, whole_weight/vol)
aba_inf <- aba[grep("I", aba$sex),]
aba_mf <- aba[grep("M|F", aba$sex),]
#testing volume and density as predictors
#model wih individual components of volume
vol_0 <- lm(rings ~ sex + height + diameter + length, data = aba)
vol_1 <- lm(rings ~ sex + vol, data = aba)
summary(vol_0)
summary(vol_1)
#model wih individual components of volume
dens_0 <- lm(rings ~ sex + vol + whole_weight, data = aba)
dens_1 <- lm(rings ~ sex + dens, data = aba)
summary(vol_0)
summary(vol_1)
#testing volume and density as predictors
#model wih individual components of volume
vol_0 <- lm(rings ~ sex + height + diameter + length, data = aba)
vol_1 <- lm(rings ~ sex + vol, data = aba)
summary(vol_0)
summary(vol_1)
#model wih individual components of volume
dens_0 <- lm(rings ~ sex + vol + whole_weight, data = aba)
dens_1 <- lm(rings ~ sex + dens, data = aba)
summary(dens_0)
summary(dens_1)
aaba = aba
#split into training and test sets
set.seed(1)
n = nrow(aba)
n = round(n*0.3)
ind = sample(x = 1:nrow(aba), size = n)
test = aba[ind,]
aba = aba[-ind,] #training set
summary(aba$sex)
sum(summary(aba$sex))
c(1307, 1340, 1528)/4175
summary(test$sex)
sum(summary(test$sex))
c(1307, 1340, 1528)/4175
#abalone project
setwd("/Users/Xiao/Desktop/2016_fall/STA206/final_project/")
install.packages("pdflatex")
rm(list = ls())
data_2d <- read.csv("2D_area_clean.csv", header = TRUE)
data_3d <- read.csv("3D_area.csv", header = TRUE)
data_t <- merge(data_2d, data_3d, by = "plant_id")
install.packages("ggplot2")
head(data_t)
plot(area ~ area_20131113, data = data_t)
with(data = data_t, identify(area, area_20131113, labels = row.names(data_t)))
plot(area ~ area_20131113, data = data_t)
plot(area ~ area_20131113 + shelf.x, data = data_t)
library(ggplot2)
ggplot(data_t, aes(x = area, y = area_20131113)) + geom_point() + facet_wrap(~.shelf.x)
ggplot(data_t, aes(x = area, y = area_20131113)) + geom_point() + facet_wrap(~shelf.x)
ggplot(data_t, aes(x = area, y = area_20131113)) + geom_point() + facet_wrap(~shelf.x)
ggplot(data_t, aes(x = area, y = area_20131113)) + geom_point() + facet_wrap(~shelf.x)
data_s5 <- data_t[grep("5", data_t$shelf.x),]
data_s4 <- data_t[grep("5", data_t$shelf.x),]
reg_log <- lm(log(area_20131113) ~ log(area), data = data_s4)
plot(reg_log)
reg_res <- residuals(reg_log)
outlier_thres <- 0.5
data_s4$res <- residuals(reg_log)
outlier_thres <- 0.5
reg_out <- data_s4[abs(data_s4$res) > outlier_thres,]
reg_out
data_s4 <- data_t[grep("4", data_t$shelf.x),]
reg_log <- lm(log(area_20131113) ~ log(area), data = data_s4)
plot(reg_log)
data_s4$res <- residuals(reg_log)
outlier_thres <- 0.5
reg_out <- data_s4[abs(data_s4$res) > outlier_thres,]
reg_out
qtukey(0.95, 3, 18)
qtukey(0.95, 3, 38)
rm(list = ls())
age <- c(rep("15-24",3),
rep("25-35",3),
rep("35-44",3),
rep("45-54",3),
rep("55-64",3))
diet <- rep(c("Low", "Medium", "High"),5)
fat <- c(0.73, 0.67, 0.15, 0.86, 0.75, 0.21, 0.94, 0.81, 0.26,
1.40, 1.32, 0.75, 1.62, 1.41, 0.78)
fat_df <- data.frame(age, diet, fat)
names(fat_df) <- c("Age", "Diet", "Fat")
str(fat_df)
par(mfrow = c(1,1))
fat_aov <- aov(Fat ~ as.factor(Age) + as.factor(Diet), data = fat_df)
summary(fat_aov)
fat_er <- matrix(fat_aov$residuals, ncol = 3, nrow = 5, byrow = TRUE)
colnames(fat_er) <- c("Low", "Medium", "High")
rownames(fat_er) <- unique(age)
fat_er
plot(fat_aov)
tukey.test(fat_mat, 0.01, )
ov_mean <- mean(colMeans(fat_mat))
col_mean <- colMeans(fat_mat)
row_mean <- rowMeans(fat_mat)
ov_mean
row_mean
col_mean
out_prod <- (row_mean-ov_mean) %o% (col_mean-ov_mean)
ov_mean <- mean(colMeans(fat_mat))
col_mean <- colMeans(fat_mat)
fat_mat <- matrix(fat, ncol = 3, nrow = 5, byrow = TRUE)
with(data = fat_df, interaction.plot(Diet, Age, Fat))
fat_df
mean(fat_df$Fat)
ov_mean <- mean(colMeans(fat_mat))
col_mean <- colMeans(fat_mat)
row_mean <- rowMeans(fat_mat)
ov_mean
row_mean
col_mean
out_prod <- (row_mean-ov_mean) %o% (col_mean-ov_mean)
SSBLTR_num <- sum(out_prod * fat_mat)^2
summary(fat_aov)
SSBLTR_den <- (1.3203/5 * 1.419/3)
SSBLTR <- SSBLTR_num/SSBLTR_den
SSBLTR
SSRem <- 0.0193 - SSBLTR
SSRem
f_stat <- SSBLTR/(SSRem/(15 - 5 - 3))
f_stat
qf(0.99,1,7)
pf(6.457578, 1, 7, lower.tail = FALSE)
summary(fat_aov)
fat_df$Diet <- factor(fat_df$Diet, levels = c("Low", "Medium", "High"))
library(ggplot2)
dfwc <- summary
ggplot(fat_df, aes(x = Diet, y = Fat)) +
stat_summary(fun.y = mean, geom = "bar") +
stat_summary(fun.data = mean_cl_normal, geom = "errorbar") +
ylab("Total fat level in plasma") +
ggtitle("Diet means barplot")
diet_means <- colMeans(fat_mat)
fat_lm <- lm(Fat ~ Diet, data = fat_df)
confint(fat_lm, level = 0.95)
qf(0.95, 2,8)
summary(fat_aov)
col_mean
fat_d1 <- col_mean[1] - col_mean[2]
fat_d2 <- col_mean[2] - col_mean[3]
fat_se <- sqrt(0.0024*(2/5))
fat_bonf <- qt(1-0.05/(2*2),df = 8)
fat_c1 <- c(fat_d1 - fat_se*fat_bonf, fat_d1 + fat_se*fat_bonf)
fat_c2 <- c(fat_d2 - fat_se*fat_bonf, fat_d2 + fat_se*fat_bonf)
fat_c1
fat_c2
print(c(fat_c1, fat_c2))
summary(fat_aov)
qf(0.95, 4, 8)
qtukey(0.95, 3, 18)
qtukey(0.95, 3, 38)
exp1 = data.frame( response = 1+rnorm(7*4),
block = as.factor( rep(1:7, times = 4) ),
treat = as.factor( rep(1:4, each =7 )))
attach( exp1 )
exp1.aov = aov( lm( response~block+treat ))  ## fit anova model
str(exp1.aov)
exp1.residuals   = exp1.aov$residuals
exp1.fittedvalue = exp1.aov$fitted.values
plot(exp1.residuals~exp1.fittedvalue)  # resid v.s. fitted val
qqnorm( exp1.residuals )               # qqplot
library(ggplot2)
ggplot(data = exp1,  aes( y = response, x = treat, linetype = block, group=block )) +
geom_line() + geom_point()+ ggtitle("Resp v.s. Treat by Block")
plot( response, x = as.numeric(treat), type='n',
main = "Resp v.s. Treat by Block",
xlab = 'treat',
ylab = 'response')
sapply(1:7, function(i){
data= subset(exp1, block == i )
lines( y = data$response, x = as.numeric(data$treat), lty = i  )
})   # you may add a legend
summary(exp1.aov)
treat.mean = sapply(1:4, function(i) mean( subset(exp1$response, exp1$treat == i )) )
bar_interval = data.frame(treat = 1:4,
mu_i  = treat.mean,
lower_bound = treat.mean - 0.049,
upper_bound = treat.mean +0.049)
ggplot(data = bar_interval, aes(y=mu_i,x = treat)) +
geom_bar(stat = 'identity') +
geom_errorbar(aes(ymax = upper_bound, ymin = lower_bound), width = 0.3, colour='red') +
ggtitle('Bar-Interval')
?mean_cl_normal
x <- rnorm(100)
mean_cl_boo(x)
mean_cl_boot(x)
install.packages("ggplot2", dependencies = TRUE)
install.packages("ggplot2", dependencies = TRUE)
install.packages("ggplot2", dependencies = TRUE)
install.packages("ggplot2", dependencies = TRUE)
install.packages("ggplot2", dependencies = TRUE)
library(ggplot2)
remove.packages("ggplot2", lib="~/R/win-library/3.3")
warnings()
install.packages("ggplot2", dependencies = TRUE)
library(ggplot2)
devtools::install_github("csgillespie/efficientR")
devtools::install_github("csgillespie/efficientR")
devtools::install_github("csgillespie/efficientR")
remove.packages("RcppEigen", lib="~/R/win-library/3.3")
install.packages("Rcpp")
devtools::install_github("csgillespie/efficientR")
devtools::install_github("csgillespie/efficientR")
install.packages('installr')
library(installr)
updateR()
install.packages(ask = FALSE)
update.packages(ask = FALSE)
update.packages()
update.packages()
install.packages("RcppEigen")
install.packages("RcppEigen")
Sys.getenv('PATH')
system('g++ -v')
install.packages("RcppEigen")
update.packages()
update.packages(ask = FALSE)
install.packages("gfortran")
install.packages("gfortran")
Sys.getenv("PATH")
system('g++ -v')
system('where make')
dotR <- file.path(Sys.getenv("HOME"), ".R")
if (!file.exists(dotR))
dir.create(dotR)
M <- file.path(dotR, "Makevars")
if (!file.exists(M))
file.create(M)
cat("\nCXXFLAGS=-O3 -Wno-unused-variable -Wno-unused-function",
file = M, sep = "\n", append = TRUE)
cat('Sys.setenv(BINPREF = "C:/Rtools/mingw_$(WIN)/bin/")',
file = file.path(Sys.getenv("HOME"), ".Rprofile"),
sep = "\n", append = TRUE)
cat(readLines(M), sep = "\n")
cat(M)
install.packages("rstan", repos = "https://cloud.r-project.org/", dependencies=TRUE)
update.packages()
y
y
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(echo = TRUE)
library(qtl)
install.packages("qtl")
install.packages("qtlbook")
install.packages("circlize")
install.packages("snow")
install.packages("circlize")
install.packages("data.table")
knitr::opts_chunk$set(echo = TRUE)
library(qtl)
library(qtlbook)
require(snow)
library(circlize)
library(data.table)
rm(list = ls())
setwd("/Users/jkhta/Desktop/nam_cam_fixing/8 - qtl_analysis/output/")
load("E:/runcie_lab/shade_avoidance_data_and_scripts/8 - qtl_analysis/output/col_sha_orig_and_area_and_pc_analysis.RData")
warnings()
geno_all_qtls <- read.csv("E:/runcie_lab/shade_avoidance_papers/figures/tables/geno_single_col_sha_qtl_intervals.csv", header = TRUE, stringsAsFactors = FALSE)
warnings()
install.packages("å£®cales")
install.packages("bookdown")
install.packages("rmarkdown")
install.packages("tufte")
install.packages("knitr")
knitr::opts_chunk$set(echo = TRUE, fig.align = "center")
library(knitr)
library(ggplot2)
rm(list = ls())
one <- seq(0, 1, by = 0.01)
two <- seq(0, 1, by = 0.01)
three <- 1 - (one * two)
plot(three)
plot(one, three)
three <- (1 - one) * (1 - two)
plot(one, three)
setwd("/Users/James/Desktop/")
oil_data = read.csv('austr_soy.csv')
str(oil_data)
oil_data$year = as.factor(oil_data$year)
with(oil_data,table(loc,year))
ggplot(oil_data,aes(x=yield,y=oil)) + geom_point()
library(lmerTest)
ggplot(oil_data,aes(x=yield,y=oil)) + geom_point(aes(color = gen)) + geom_smooth(aes(color = gen),se=F,method='lm')
-log10(0.01)
-log10(0.001)
#script to merge and plot direct and indirect effects
library(data.table)
library(ggplot2)
rm(list = ls())
install.packages("ggpubr")
library(ggpubr)
rm(list = ls())
setwd("/Users/James/Documents/GitHub/sar_qtl/7_path_analysis/output/")
path_data <- rbindlist(lapply(list.files(pattern = "path_eff_FRIFLC.csv"),
function(x) fread(x, sep = ",", header = TRUE, stringsAsFactors = FALSE)))
path_data$pop_facet <- factor(path_data$pop, levels = c("sha", "oy", "jea", "ita", "cvi", "bur", "blh"))
path_data$trait_facet <- factor(path_data$trait, levels = c("bd", "rdry", "h3h1", "idry"))
path_data_FRI_FLC <- subset(path_data, allele_comb == "FRIFLC")
#looking at fri and flc individually
path_data_FRI_FLC_ind <- rbindlist(lapply(list.files(pattern = "path_eff_alt.csv"),
function(x) fread(x, sep = ",", header = TRUE, stringsAsFactors = FALSE)))
path_data_FRI_FLC_ind$pop_facet <- factor(path_data_FRI_FLC_ind$pop, levels = c("sha", "oy", "jea", "ita", "cvi", "bur", "blh"))
path_data_FRI_FLC_ind$trait_facet <- factor(path_data_FRI_FLC_ind$trait, levels = c("bd", "rdry", "h3h1", "idry"))
path_data_FRI_FLC_ind
library(plyr)
path_data_FRI_FLC_ind$pop <- revalue(path_data_FRI_FLC_ind$pop, c("sha" = "Sha x Col-0", "oy" = "Oy-0 x Col-0", "jea" = "Jea x Col-0", "ita" = "Ita-0 x Col-0", "cvi" = "Cvi-0 x Col-0", "bur" = "Bur-0 x Col-0", "blh" = "Blh-1 x Col-0"))
path_data_FRI_FLC_ind$pop
path_data_FRI_FLC_ind$pop_facet <- factor(path_data_FRI_FLC_ind$pop, levels = c("sha" = "Sha x Col-0", "oy" = "Oy-0 x Col-0", "jea" = "Jea x Col-0", "ita" = "Ita-0 x Col-0", "cvi" = "Cvi-0 x Col-0", "bur" = "Bur-0 x Col-0", "blh" = "Blh-1 x Col-0"))
path_data_FRI_FLC_ind$trait_facet <- factor(path_data_FRI_FLC_ind$trait, levels = c("bd", "rdry", "h3h1", "idry"))
path_data_diff_B4 <- subset(path_data_FRI_FLC_ind, env == "diff" & allele_comb == "B4")
path_data_diff_B5 <- subset(path_data_FRI_FLC_ind, env == "diff" & allele_comb == "B5")
path_data_diff_B5_ggplot <- ggplot(data = path_data_allele_subset, aes(x = est, y = pop_facet, color = effect_type)) +
geom_point() +
geom_errorbarh(aes(xmax = est + se, xmin = est - se), height = 0.1) +
geom_vline(xintercept = 0,
color = "black", size = 0.25) +
facet_wrap(~ trait_facet, nrow = 1) +
xlab("QTL effect") +
ylab("Population") +
theme(legend.text = element_text(size = 20),
legend.title = element_blank(),
axis.title = element_text(size = 20),
axis.text.y = element_text(size = 20),
plot.title = element_text(hjust = 0.5)) +
ggtitle("SAR5")
path_data_diff_B4 <- subset(path_data_FRI_FLC_ind, env == "diff" & allele_comb == "B4")
path_data_diff_B4_ggplot <- ggplot(data = path_data_diff_B4, aes(x = est, y = pop_facet, color = effect_type)) +
geom_point() +
geom_errorbarh(aes(xmax = est + se, xmin = est - se), height = 0.1) +
geom_vline(xintercept = 0,
color = "black", size = 0.25) +
facet_wrap(~ trait_facet, nrow = 1) +
xlab("QTL effect") +
ylab("Population") +
theme(legend.text = element_text(size = 20),
legend.title = element_blank(),
axis.title = element_text(size = 20),
axis.text.y = element_text(size = 20),
plot.title = element_text(hjust = 0.5)) +
ggtitle("SAR4")
path_data_diff_B5 <- subset(path_data_FRI_FLC_ind, env == "diff" & allele_comb == "B5")
path_data_diff_B5_ggplot <- ggplot(data = path_data_diff_B5, aes(x = est, y = pop_facet, color = effect_type)) +
geom_point() +
geom_errorbarh(aes(xmax = est + se, xmin = est - se), height = 0.1) +
geom_vline(xintercept = 0,
color = "black", size = 0.25) +
facet_wrap(~ trait_facet, nrow = 1) +
xlab("QTL effect") +
ylab("Population") +
theme(legend.text = element_text(size = 20),
legend.title = element_blank(),
axis.title = element_text(size = 20),
axis.text.y = element_text(size = 20),
plot.title = element_text(hjust = 0.5)) +
ggtitle("SAR5")
ggarrange(path_data_diff_B4_ggplot, path_data_diff_B5_ggplot,
labels = c("A", "B"),
ncol = 2)
path_data_FRI_FLC_ind$pop <- revalue(path_data_FRI_FLC_ind$pop, c("sha" = "Sha", "oy" = "Oy-0", "jea" = "Jea", "ita" = "Ita-0", "cvi" = "Cvi-0", "bur" = "Bur-0", "blh" = "Blh-1"))
path_data_FRI_FLC_ind$pop_facet <- factor(path_data_FRI_FLC_ind$pop, levels = c("sha" = "Sha", "oy" = "Oy-0", "jea" = "Jea", "ita" = "Ita-0", "cvi" = "Cvi-0", "bur" = "Bur-0", "blh" = "Blh-1"))
#looking at fri and flc individually
path_data_FRI_FLC_ind <- rbindlist(lapply(list.files(pattern = "path_eff_alt.csv"),
function(x) fread(x, sep = ",", header = TRUE, stringsAsFactors = FALSE)))
path_data_FRI_FLC_ind$pop <- revalue(path_data_FRI_FLC_ind$pop, c("sha" = "Sha", "oy" = "Oy-0", "jea" = "Jea", "ita" = "Ita-0", "cvi" = "Cvi-0", "bur" = "Bur-0", "blh" = "Blh-1"))
path_data_FRI_FLC_ind$pop_facet <- factor(path_data_FRI_FLC_ind$pop, levels = c("sha" = "Sha", "oy" = "Oy-0", "jea" = "Jea", "ita" = "Ita-0", "cvi" = "Cvi-0", "bur" = "Bur-0", "blh" = "Blh-1"))
path_data_diff_B4_ggplot <- ggplot(data = path_data_diff_B4, aes(x = est, y = pop_facet, color = effect_type)) +
geom_point() +
geom_errorbarh(aes(xmax = est + se, xmin = est - se), height = 0.1) +
geom_vline(xintercept = 0,
color = "black", size = 0.25) +
facet_wrap(~ trait_facet, nrow = 1) +
xlab("QTL effect") +
ylab("Non-recurrent parent population") +
theme(legend.text = element_text(size = 20),
legend.title = element_blank(),
axis.title = element_text(size = 20),
axis.text.y = element_text(size = 20),
plot.title = element_text(hjust = 0.5)) +
ggtitle("SAR4")
path_data_diff_B5_ggplot <- ggplot(data = path_data_diff_B5, aes(x = est, y = pop_facet, color = effect_type)) +
geom_point() +
geom_errorbarh(aes(xmax = est + se, xmin = est - se), height = 0.1) +
geom_vline(xintercept = 0,
color = "black", size = 0.25) +
facet_wrap(~ trait_facet, nrow = 1) +
xlab("QTL effect") +
ylab("Population") +
theme(legend.text = element_text(size = 20),
legend.title = element_blank(),
axis.title = element_text(size = 20),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
plot.title = element_text(hjust = 0.5)) +
ggtitle("SAR5")
ggarrange(path_data_diff_B4_ggplot, path_data_diff_B5_ggplot,
labels = c("A", "B"),
ncol = 2)
path_data_diff_B4_ggplot <- ggplot(data = path_data_diff_B4, aes(x = est, y = pop_facet, color = effect_type)) +
geom_point() +
geom_errorbarh(aes(xmax = est + se, xmin = est - se), height = 0.1) +
geom_vline(xintercept = 0,
color = "black", size = 0.25) +
facet_wrap(~ trait_facet, nrow = 1) +
xlab("QTL effect") +
ylab("Non-recurrent parent population") +
theme(legend.text = element_text(size = 20),
legend.title = element_blank(),
axis.title = element_text(size = 20),
axis.text.y = element_text(size = 20),
plot.title = element_text(hjust = 0.5),
legend.position = "none") +
ggtitle("SAR4")
ggarrange(path_data_diff_B4_ggplot, path_data_diff_B5_ggplot,
labels = c("A", "B"),
ncol = 2)
path_data_diff_B4 <- subset(path_data_FRI_FLC_ind, env == "diff" & allele_comb == "B4")
path_data_diff_B4_ggplot <- ggplot(data = path_data_diff_B4, aes(x = est, y = pop_facet, color = effect_type)) +
geom_point() +
geom_errorbarh(aes(xmax = est + se, xmin = est - se), height = 0.1) +
geom_vline(xintercept = 0,
color = "black", size = 0.25) +
facet_wrap(~ trait_facet, nrow = 1) +
xlab("QTL effect") +
ylab("Non-recurrent parent population") +
theme(legend.text = element_text(size = 20),
legend.title = element_blank(),
axis.title = element_text(size = 20),
axis.text.y = element_text(size = 20),
plot.title = element_text(hjust = 0.5),
legend.position = "none") +
ggtitle("SAR4")
path_data_diff_B5 <- subset(path_data_FRI_FLC_ind, env == "diff" & allele_comb == "B5")
path_data_diff_B5_ggplot <- ggplot(data = path_data_diff_B5, aes(x = est, y = pop_facet, color = effect_type)) +
geom_point() +
geom_errorbarh(aes(xmax = est + se, xmin = est - se), height = 0.1) +
geom_vline(xintercept = 0,
color = "black", size = 0.25) +
facet_wrap(~ trait_facet, nrow = 1) +
xlab("QTL effect") +
ylab("Population") +
theme(legend.text = element_text(size = 20),
legend.title = element_blank(),
axis.title = element_text(size = 20),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
plot.title = element_text(hjust = 0.5)) +
ggtitle("SAR5")
ggarrange(path_data_diff_B4_ggplot, path_data_diff_B5_ggplot,
labels = c("A", "B"),
ncol = 2)
rm(list = ls())
setwd("/Users/James/Documents/GitHub/sar_qtl/7_path_analysis/output/")
path_data <- rbindlist(lapply(list.files(pattern = "path_eff_FRIFLC.csv"),
function(x) fread(x, sep = ",", header = TRUE, stringsAsFactors = FALSE)))
path_data$pop_facet <- factor(path_data$pop, levels = c("sha", "oy", "jea", "ita", "cvi", "bur", "blh"))
path_data$trait_facet <- factor(path_data$trait, levels = c("bd", "rdry", "h3h1", "idry"))
path_data_FRI_FLC <- subset(path_data, allele_comb == "FRIFLC")
#looking at fri and flc individually
path_data_FRI_FLC_ind <- rbindlist(lapply(list.files(pattern = "path_eff_alt.csv"),
function(x) fread(x, sep = ",", header = TRUE, stringsAsFactors = FALSE)))
path_data_FRI_FLC_ind$pop <- revalue(path_data_FRI_FLC_ind$pop, c("sha" = "Sha", "oy" = "Oy-0", "jea" = "Jea", "ita" = "Ita-0", "cvi" = "Cvi-0", "bur" = "Bur-0", "blh" = "Blh-1"))
path_data_FRI_FLC_ind$pop_facet <- factor(path_data_FRI_FLC_ind$pop, levels = c("sha" = "Sha", "oy" = "Oy-0", "jea" = "Jea", "ita" = "Ita-0", "cvi" = "Cvi-0", "bur" = "Bur-0", "blh" = "Blh-1"))
path_data_FRI_FLC_ind$trait_facet <- factor(path_data_FRI_FLC_ind$trait, levels = c("bd", "rdry", "h3h1", "idry"))
path_data_diff_B4 <- subset(path_data_FRI_FLC_ind, env == "diff" & allele_comb == "B4")
path_data_diff_B4_ggplot <- ggplot(data = path_data_diff_B4, aes(x = est, y = pop_facet, color = effect_type)) +
geom_point() +
geom_errorbarh(aes(xmax = est + se, xmin = est - se), height = 0.1) +
geom_vline(xintercept = 0,
color = "black", size = 0.25) +
facet_wrap(~ trait_facet, nrow = 1) +
xlab("QTL effect") +
ylab("Non-recurrent parent population") +
theme(legend.text = element_text(size = 20),
legend.title = element_blank(),
axis.title = element_text(size = 20),
axis.text.y = element_text(size = 20),
plot.title = element_text(hjust = 0.5),
legend.position = "none") +
ggtitle("SAR4")
path_data_diff_B5 <- subset(path_data_FRI_FLC_ind, env == "diff" & allele_comb == "B5")
path_data_diff_B5_ggplot <- ggplot(data = path_data_diff_B5, aes(x = est, y = pop_facet, color = effect_type)) +
geom_point() +
geom_errorbarh(aes(xmax = est + se, xmin = est - se), height = 0.1) +
geom_vline(xintercept = 0,
color = "black", size = 0.25) +
facet_wrap(~ trait_facet, nrow = 1) +
xlab("QTL effect") +
ylab("Population") +
theme(legend.text = element_text(size = 20),
legend.title = element_blank(),
axis.title = element_text(size = 20),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
plot.title = element_text(hjust = 0.5)) +
ggtitle("SAR5")
ggarrange(path_data_diff_B4_ggplot, path_data_diff_B5_ggplot,
labels = c("A", "B"),
ncol = 2)
path_data_FRI_FLC_ind$pop
path_data_FRI_FLC_ind$pop_facet
path_data_diff_B4_ggplot
plot(path_data_diff_B4_ggplot)
